setwd("/Users/christianhenry/Dropbox/PostDoc/SpatialPhylo/PricePack/PhyloMaker")

library(RRphylo)
library(phytools)
library(V.PhyloMaker2)

#---Make phylogeny for one family---
{
fam_names <- read.csv("Amaranthaceae.csv")

tree1 <- phylo.maker(sp.list = fam_names, tree = GBOTB.extended.TPL, nodes = nodes.info.1.TPL, scenarios = "S3")

plot(tree1$scenario.3)

write.tree(tree1$scenario.3, "sample.tre")
}


#Fix polytomies
{
  newtree5<-fix.poly(result[[5]],type=c("resolve"),node=NULL,tol=1e-10,random   =TRUE)

#Save new and fixed trees
  write.tree(newtree1, "Amaranthaceae.tre")
}

#---Now that family trees are created, lets plot trait evolution---
{
    tree <- read.newick("Amaranthaceae.tre")
    ContVals<-read.csv("Amaranthaceae_data.csv", row.names = 1)

    sp_range<-as.factor(setNames(ContVals[,1],rownames(ContVals)))
    obj<-contMap(tree,sp_range,plot=FALSE)

    plot(obj,outline=FALSE)
  }

